--
-- ER/Studio Data Architect SQL Code Generation
-- Project :      Chicago_Dallas_DIM_Model.DM1
--
-- Date Created : Sunday, April 20, 2025 12:54:40
-- Target DBMS : Snowflake
--

-- 
-- TABLE: DIM_DATE 
--

CREATE TABLE DIM_DATE(
    DATE_ID_SK            INTEGER         NOT NULL,
    DAY_NUM               NUMBER(2, 0),
    DAY_NAME              VARCHAR(50),
    DAY_ABBR              VARCHAR(3),
    IS_WEEKEND            NUMBER(2, 0),
    MONTH_NAME            VARCHAR(10),
    MONTH_ABBR            VARCHAR(5),
    MONTH_NUM             CHAR(10),
    DT                    DATE,
    YEAR_NUM              NUMBER(4, 0),
    DATA_SOURCE_ID        VARCHAR(50),
    DATA_WORKFLOW_NAME    VARCHAR(50),
    DW_JOB_ID             VARCHAR(50),
    DW_LOAD_DT            DATE,
    CONSTRAINT DATE_ID_SK_PK PRIMARY KEY (DATE_ID_SK) 
)
;



-- 
-- TABLE: DIM_INSPECTION 
--

CREATE TABLE DIM_INSPECTION(
    INSPECTION_ID_SK      INTEGER        NOT NULL,
    INSPECTION_TYPE       VARCHAR(50),
    DATA_SOURCE_ID        VARCHAR(50),
    DATA_WORKFLOW_NAME    VARCHAR(50),
    DW_JOB_ID             VARCHAR(50),
    DW_LOAD_DT            DATE,
    CONSTRAINT PK3 PRIMARY KEY (INSPECTION_ID_SK) 
)
;



-- 
-- TABLE: DIM_LOCATION 
--

CREATE TABLE DIM_LOCATION(
    LOCATION_ID_SK        INTEGER         NOT NULL,
    STREET_ADDRESS        VARCHAR(100),
    CITY                  VARCHAR(50),
    STATE                 VARCHAR(50),
    ZIP                   VARCHAR(50),
    LATITUDE              FLOAT,
    LONGITUDE             FLOAT,
    LOCATION              VARCHAR(100),
    DATA_SOURCE_ID        VARCHAR(50),
    DATA_WORKFLOW_NAME    VARCHAR(50),
    DW_JOB_ID             VARCHAR(50),
    DW_LOAD_DT            DATE,
    CONSTRAINT LOCATION_ID_SK_PK PRIMARY KEY (LOCATION_ID_SK) 
)
;



-- 
-- TABLE: DIM_RESTAURANT 
--

CREATE TABLE DIM_RESTAURANT(
    RESTAURANT_ID_SK      INTEGER         NOT NULL,
    RESTAURANT_NAME       VARCHAR(100),
    ALSO_KNOWN_AS_NAME    VARCHAR(100),
    LICENSE_NUMBER        INTEGER,
    FACILITY_TYPE         VARCHAR(50),
    DATA_SOURCE_ID        VARCHAR(50),
    DATA_WORKFLOW_NAME    VARCHAR(50),
    DW_JOB_ID             VARCHAR(50),
    DW_LOAD_DT            DATE,
    CONSTRAINT RESTAURANT_ID_SK_PK PRIMARY KEY (RESTAURANT_ID_SK) 
)
;



-- 
-- TABLE: DIM_RESULTS 
--

CREATE TABLE DIM_RESULTS(
    RESULT_ID_SK          INTEGER        NOT NULL,
    INSPECTION_RESULTS    VARCHAR(50),
    DATA_SOURCE_ID        VARCHAR(50),
    DATA_WORKFLOW_NAME    VARCHAR(50),
    DW_JOB_ID             VARCHAR(50),
    DW_LOAD_DT            DATE,
    CONSTRAINT RISK_ID_SK_PK PRIMARY KEY (RESULT_ID_SK) 
)
;



-- 
-- TABLE: DIM_RISK 
--

CREATE TABLE DIM_RISK(
    RISK_ID_SK            INTEGER        NOT NULL,
    RISK_LEVEL            VARCHAR(50),
    DATA_SOURCE_ID        VARCHAR(50),
    DATA_WORKFLOW_NAME    VARCHAR(50),
    DW_JOB_ID             VARCHAR(50),
    DW_LOAD_DT            DATE,
    CONSTRAINT RISK_ID_SK_PK PRIMARY KEY (RISK_ID_SK) 
)
;



-- 
-- TABLE: DIM_VIOLATION 
--

CREATE TABLE DIM_VIOLATION(
    VIOLATION_ID_SK          INTEGER         NOT NULL,
    VIOLATION_CODE           VARCHAR(50),
    VIOLATION_DESCRIPTION    VARCHAR(100),
    DATA_SOURCE_ID           VARCHAR(50),
    DATA_WORKFLOW_NAME       VARCHAR(50),
    DW_JOB_ID                VARCHAR(50),
    DW_LOAD_DT               DATE,
    CONSTRAINT VIOLATION_IS_SK_PK PRIMARY KEY (VIOLATION_ID_SK) 
)
;



-- 
-- TABLE: FACT_INSPECTION 
--

CREATE TABLE FACT_INSPECTION(
    FACT_INSPECTION_ID_SK    INTEGER           NOT NULL,
    RESTAURANT_ID_SK         INTEGER           NOT NULL,
    LOCATION_ID_SK           INTEGER           NOT NULL,
    INSPECTION_ID_SK         INTEGER           NOT NULL,
    RISK_ID_SK               INTEGER           NOT NULL,
    DATE_ID_SK               INTEGER           NOT NULL,
    RESULT_ID_SK             INTEGER           NOT NULL,
    VIOLATION_ID_SK          INTEGER           NOT NULL,
    VIOLATION_COMMENT        VARCHAR(12000),
    INSPECTION_CNT           INTEGER,
    DATA_SOURCE_ID           VARCHAR(50),
    DATA_WORKFLOW_NAME       VARCHAR(50),
    DW_JOB_ID                VARCHAR(50),
    DW_LOAD_DT               DATE,
    CONSTRAINT FACT_INSPECTION_ID_SK_PK PRIMARY KEY (FACT_INSPECTION_ID_SK, RESTAURANT_ID_SK, LOCATION_ID_SK, INSPECTION_ID_SK, RISK_ID_SK, DATE_ID_SK, RESULT_ID_SK, VIOLATION_ID_SK) 
)
;



-- 
-- TABLE: FACT_INSPECTION 
--

ALTER TABLE FACT_INSPECTION ADD CONSTRAINT RefDIM_RESTAURANT2 
    FOREIGN KEY (RESTAURANT_ID_SK)
    REFERENCES DIM_RESTAURANT(RESTAURANT_ID_SK)
;

ALTER TABLE FACT_INSPECTION ADD CONSTRAINT RefDIM_LOCATION3 
    FOREIGN KEY (LOCATION_ID_SK)
    REFERENCES DIM_LOCATION(LOCATION_ID_SK)
;

ALTER TABLE FACT_INSPECTION ADD CONSTRAINT RefDIM_INSPECTION5 
    FOREIGN KEY (INSPECTION_ID_SK)
    REFERENCES DIM_INSPECTION(INSPECTION_ID_SK)
;

ALTER TABLE FACT_INSPECTION ADD CONSTRAINT RefDIM_RISK6 
    FOREIGN KEY (RISK_ID_SK)
    REFERENCES DIM_RISK(RISK_ID_SK)
;

ALTER TABLE FACT_INSPECTION ADD CONSTRAINT RefDIM_DATE7 
    FOREIGN KEY (DATE_ID_SK)
    REFERENCES DIM_DATE(DATE_ID_SK)
;

ALTER TABLE FACT_INSPECTION ADD CONSTRAINT RefDIM_RESULTS8 
    FOREIGN KEY (RESULT_ID_SK)
    REFERENCES DIM_RESULTS(RESULT_ID_SK)
;

ALTER TABLE FACT_INSPECTION ADD CONSTRAINT RefDIM_VIOLATION17 
    FOREIGN KEY (VIOLATION_ID_SK)
    REFERENCES DIM_VIOLATION(VIOLATION_ID_SK)
;


